{"id":"juice-shop-is-susceptible-to-xss-attacks;haxxor-can-inject-a-payload-into-the-page","name":"Haxxor can inject a payload into the page","title":"Haxxor can inject a payload into the page","manual":false,"testSteps":[{"number":1,"description":"Given Haxxor goes to the Juice Shop","startTime":"2025-06-15T10:47:55.416Z","children":[{"number":2,"description":"Haxxor opens the Juice Shop","startTime":"2025-06-15T10:47:55.433Z","children":[{"number":3,"description":"Haxxor navigates to &quot;/&quot;","startTime":"2025-06-15T10:47:55.433Z","children":[{"number":4,"description":"Haxxor ensures that true does equal true","startTime":"2025-06-15T10:47:55.787Z","children":[],"reportData":[],"screenshots":[],"duration":1,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":1528,"result":"SUCCESS","restQuery":{"method":"GET","path":"https://stc-owasp-juice-dnebatcgf2ddf4cr.uksouth-01.azurewebsites.net/api/Challenges/?name=DOM%20XSS","content":"","contentType":"","requestHeaders":"Accept: application/json, text/plain, */*\nUser-Agent: axios/1.9.0\nAccept-Encoding: gzip, compress, deflate, br","requestCookies":"","statusCode":200,"responseHeaders":"content-length: 730\nconnection: close\ncontent-type: application/json; charset=utf-8\ndate: Sun, 15 Jun 2025 10:47:55 GMT\naccess-control-allow-origin: *\netag: W/\"2da-A4ibrHFmwgZewCQfl+v0EbVFEkM\"\nvary: Accept-Encoding\nx-content-type-options: nosniff\nx-frame-options: SAMEORIGIN\nfeature-policy: payment 'self'\nx-recruiting: /#/jobs","responseCookies":"","responseBody":"{\n    \"status\": \"success\",\n    \"data\": [\n        {\n            \"id\": 19,\n            \"key\": \"localXssChallenge\",\n            \"name\": \"DOM XSS\",\n            \"category\": \"XSS\",\n            \"tags\": \"Tutorial,Good for Demos\",\n            \"description\": \"Perform a <i>DOM</i> XSS attack with <code>&lt;iframe src=\\\"javascript:alert(`xss`)\\\"&gt;</code>.\",\n            \"difficulty\": 1,\n            \"hint\": \"Look for an input field where its content appears in the HTML when its form is submitted.\",\n            \"hintUrl\": \"https://pwning.owasp-juice.shop/companion-guide/latest/part2/xss.html#_perform_a_dom_xss_attack\",\n            \"mitigationUrl\": \"https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html\",\n            \"solved\": true,\n            \"disabledEnv\": null,\n            \"tutorialOrder\": 2,\n            \"codingChallengeStatus\": 0,\n            \"createdAt\": \"2025-06-11T14:55:22.656Z\",\n            \"updatedAt\": \"2025-06-11T14:56:01.803Z\"\n        }\n    ]\n}"}},{"number":5,"description":"Haxxor sets cookie: { name: &quot;cookieconsent_status&quot;, value: &quot;dismiss&quot; }","startTime":"2025-06-15T10:47:56.972Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"},{"number":6,"description":"Haxxor sets cookie: { name: &quot;welcomebanner_status&quot;, value: &quot;dismiss&quot; }","startTime":"2025-06-15T10:47:56.984Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"},{"number":7,"description":"Haxxor sets cookie: { name: &quot;language&quot;, value: &quot;en&quot; }","startTime":"2025-06-15T10:47:56.996Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"},{"number":8,"description":"Haxxor reloads the page","startTime":"2025-06-15T10:47:57.008Z","children":[],"reportData":[],"screenshots":[],"duration":656,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":2242,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":2269,"result":"SUCCESS"},{"number":9,"description":"When she searches for &quot;&lt;iframe width=\\&quot;100%\\&quot; height=\\&quot;166\\&quot; scrolling=\\&quot;no\\&quot; frameborder=\\&quot;no\\&quot; allow=\\&quot;autoplay\\&quot; src=\\&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&amp;color=%23ff5500&amp;auto_play=true&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true\\&quot;&gt;&lt;/iframe&gt;&quot;","startTime":"2025-06-15T10:47:57.686Z","children":[{"number":10,"description":"Haxxor searches for &lt;iframe width=&quot;100%&quot; height=&quot;166&quot; scrolling=&quot;no&quot; frameborder=&quot;no&quot; allow=&quot;autoplay&quot; src=&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&amp;color=%23ff5500&amp;auto_play=true&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true&quot;&gt;&lt;/iframe&gt;","startTime":"2025-06-15T10:47:57.708Z","children":[{"number":11,"description":"Haxxor clicks on Search button","startTime":"2025-06-15T10:47:57.708Z","children":[],"reportData":[],"screenshots":[],"duration":107,"result":"SUCCESS"},{"number":12,"description":"Haxxor enters &quot;&lt;iframe width=&quot;100%&quot; height=&quot;166&quot; scrolling=&quot;no&quot; frameborder=&quot;no&quot; allow=&quot;autoplay&quot; src=&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&amp;color=%23ff5500&amp;auto_play=true&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true&quot;&gt;&lt;/iframe&gt;&quot; into Search input","startTime":"2025-06-15T10:47:57.826Z","children":[],"reportData":[],"screenshots":[],"duration":30,"result":"SUCCESS"},{"number":13,"description":"Haxxor presses key Enter in Search input","startTime":"2025-06-15T10:47:57.866Z","children":[],"reportData":[],"screenshots":[],"duration":19,"result":"SUCCESS"},{"number":14,"description":"Haxxor checks whether &apos;&lt;iframe width=&quot;100%&quot; height=&quot;166&quot; scrolling=&quot;no&quot; frameborder=&quot;no&quot; allow=&quot;autoplay&quot; src=&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&amp;color=%23ff5500&amp;auto_play=true&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true&quot;&gt;&lt;/iframe&gt;&apos; does include &quot;javascript:alert&quot;","startTime":"2025-06-15T10:47:57.895Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":199,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":231,"result":"SUCCESS"},{"number":15,"description":"Then she sees she has solved the &quot;Bonus Payload&quot; challenge","startTime":"2025-06-15T10:47:57.917Z","children":[{"number":16,"description":"Haxxor confirms that Bonus Payload has been solved","startTime":"2025-06-15T10:47:57.924Z","children":[{"number":17,"description":"Haxxor sends a GET request to &apos;/api/Challenges/?name=Bonus Payload&apos;","startTime":"2025-06-15T10:47:57.924Z","children":[],"reportData":[],"screenshots":[],"duration":0}],"reportData":[],"screenshots":[],"duration":0}],"reportData":[],"screenshots":[],"duration":9,"result":"SUCCESS"}],"userStory":{"id":"juice-shop-is-susceptible-to-xss-attacks","storyName":"Juice Shop is susceptible to XSS attacks","displayName":"Juice Shop is susceptible to XSS attacks","path":"xss-dom/xss-dom","type":"feature","narrative":"","pathElements":[{"name":"xss-dom","description":"Xss-dom"},{"name":"xss-dom","description":"Xss-dom"}]},"startTime":"2025-06-15T10:47:55.416Z","testSource":"JS","tags":[{"name":"Xss-dom","type":"capability","displayName":"Xss-dom"},{"name":"Xss-dom/Juice Shop is susceptible to XSS attacks","type":"feature","displayName":"Juice Shop is susceptible to XSS attacks"}],"featureTag":{"name":"Xss-dom/Juice Shop is susceptible to XSS attacks","type":"feature","displayName":"Juice Shop is susceptible to XSS attacks"},"actors":[{"name":"Haxxor","can":["PerformActivities","AnswerQuestions","RaiseErrors","ScheduleWork { scheduler: { clock: { timeAdjustment: { milliseconds: 0 } }, interactionTimeout: { milliseconds: 5000 } } }","BrowseTheWeb (BrowseTheWebWithPlaywright)","CallAnApi { baseURL: \"https://stc-owasp-juice-dnebatcgf2ddf4cr.uksouth-01.azurewebsites.net/#/\", headers: { common: { Accept: \"application/json, text/plain, */*\" } }, timeout: 10000 }","TakeNotes { notepad: {} }"]}],"result":"SUCCESS","duration":2533}