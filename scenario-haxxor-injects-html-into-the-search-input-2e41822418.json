{"id":"juice-shop-is-susceptible-to-xss-attacks;haxxor-injects-html-into-the-search-input","name":"Haxxor injects HTML into the search input","title":"Haxxor injects HTML into the search input","manual":false,"testSteps":[{"number":1,"description":"Given Haxxor goes to the Juice Shop","startTime":"2025-06-15T10:34:46.269Z","children":[{"number":2,"description":"Haxxor opens the Juice Shop","startTime":"2025-06-15T10:34:46.276Z","children":[{"number":3,"description":"Haxxor navigates to &quot;/&quot;","startTime":"2025-06-15T10:34:46.277Z","children":[{"number":4,"description":"Haxxor ensures that true does equal true","startTime":"2025-06-15T10:34:47.372Z","children":[],"reportData":[],"screenshots":[],"duration":1,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":2241,"result":"SUCCESS","restQuery":{"method":"GET","path":"https://stc-owasp-juice-dnebatcgf2ddf4cr.uksouth-01.azurewebsites.net/api/Challenges/?name=Score%20Board","content":"","contentType":"","requestHeaders":"Accept: application/json, text/plain, */*\nUser-Agent: axios/1.9.0\nAccept-Encoding: gzip, compress, deflate, br","requestCookies":"","statusCode":200,"responseHeaders":"content-length: 647\nconnection: close\ncontent-type: application/json; charset=utf-8\ndate: Sun, 15 Jun 2025 10:34:47 GMT\naccess-control-allow-origin: *\netag: W/\"287-ZrQ7DsInBU5XA4B3X7wAPhlzBOI\"\nvary: Accept-Encoding\nx-content-type-options: nosniff\nx-frame-options: SAMEORIGIN\nfeature-policy: payment 'self'\nx-recruiting: /#/jobs","responseCookies":"","responseBody":"{\n    \"status\": \"success\",\n    \"data\": [\n        {\n            \"id\": 74,\n            \"key\": \"scoreBoardChallenge\",\n            \"name\": \"Score Board\",\n            \"category\": \"Miscellaneous\",\n            \"tags\": \"Tutorial,Code Analysis\",\n            \"description\": \"Find the carefully hidden 'Score Board' page.\",\n            \"difficulty\": 1,\n            \"hint\": \"Try to find a reference or clue behind the scenes. Or simply guess what URL the Score Board might have.\",\n            \"hintUrl\": \"https://pwning.owasp-juice.shop/companion-guide/latest/part2/score-board.html#_find_the_carefully_hidden_score_board_page\",\n            \"mitigationUrl\": null,\n            \"solved\": true,\n            \"disabledEnv\": null,\n            \"tutorialOrder\": 1,\n            \"codingChallengeStatus\": 0,\n            \"createdAt\": \"2025-06-11T14:55:22.696Z\",\n            \"updatedAt\": \"2025-06-11T14:56:01.803Z\"\n        }\n    ]\n}"}},{"number":5,"description":"Haxxor sets cookie: { name: &quot;cookieconsent_status&quot;, value: &quot;dismiss&quot; }","startTime":"2025-06-15T10:34:48.529Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"},{"number":6,"description":"Haxxor sets cookie: { name: &quot;welcomebanner_status&quot;, value: &quot;dismiss&quot; }","startTime":"2025-06-15T10:34:48.541Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"},{"number":7,"description":"Haxxor sets cookie: { name: &quot;language&quot;, value: &quot;en&quot; }","startTime":"2025-06-15T10:34:48.553Z","children":[],"reportData":[],"screenshots":[],"duration":2,"result":"SUCCESS"},{"number":8,"description":"Haxxor reloads the page","startTime":"2025-06-15T10:34:48.566Z","children":[],"reportData":[],"screenshots":[],"duration":867,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":3167,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":3185,"result":"SUCCESS"},{"number":9,"description":"When she searches for &quot;&lt;iframe src=\\&quot;javascript:alert(`xss`)\\&quot;&gt;&quot;","startTime":"2025-06-15T10:34:49.454Z","children":[{"number":10,"description":"Haxxor searches for &lt;iframe src=&quot;javascript:alert(`xss`)&quot;&gt;","startTime":"2025-06-15T10:34:49.482Z","children":[{"number":11,"description":"Haxxor clicks on Search button","startTime":"2025-06-15T10:34:49.482Z","children":[],"reportData":[],"screenshots":[],"duration":102,"result":"SUCCESS"},{"number":12,"description":"Haxxor enters &quot;&lt;iframe src=&quot;javascript:alert(`xss`)&quot;&gt;&quot; into Search input","startTime":"2025-06-15T10:34:49.595Z","children":[],"reportData":[],"screenshots":[],"duration":19,"result":"SUCCESS"},{"number":13,"description":"Haxxor presses key Enter in Search input","startTime":"2025-06-15T10:34:49.625Z","children":[],"reportData":[],"screenshots":[],"duration":19,"result":"SUCCESS"},{"number":14,"description":"Haxxor checks whether &apos;&lt;iframe src=&quot;javascript:alert(`xss`)&quot;&gt;&apos; does include &quot;javascript:alert&quot;","startTime":"2025-06-15T10:34:49.655Z","children":[{"number":15,"description":"Haxxor waits until class ModalDialog {\n    /**\n     * Returns a promise that resolves to `true`\n     * when a modal dialog has been handled, so accepted or dismissed.\n     * Returns `false` for dialogs that haven&apos;t been handled yet.\n     *\n     * Useful when a JavaScript modal dialog is generated after a delay,\n     * e.g. triggered by `setTimeout`.\n     *\n     * #### Example usage\n     *\n     * ```ts\n     * import { actorCalled, Wait } from &apos;@serenity-js/core&apos;\n     * import { Ensure, equals, isPresent } from &apos;@serenity-js/assertions&apos;\n     * import { ModalDialog } from &apos;@serenity-js/web&apos;\n     *\n     * await actorCalled(&apos;Nick&apos;).attemptsTo(\n     *   ModalDialog.acceptNext(),\n     *   Wait.until(ModalDialog, isPresent()),\n     *   Ensure.that(ModalDialog.lastDialogState(), equals(&apos;accepted&apos;)),\n     * )\n     * ```\n     */\n    static isPresent() {\n        return Page_1.Page.current().modalDialog().last().isPresent();\n    }\n    /**\n     * Produces an [interaction](https://serenity-js.org/api/core/class/Interaction/) that invokes [`ModalDialog.acceptNext`](https://serenity-js.org/api/web/class/ModalDialog/#acceptNext).\n     */\n    static acceptNext() {\n        return Page_1.Page.current().modalDialog().acceptNext()\n            .describedAs(&apos;Haxxor accepts next modal dialog window&apos;);\n    }\n    /**\n     * Produces an [interaction](https://serenity-js.org/api/core/class/Interaction/) that invokes [`ModalDialog.acceptNextWithValue`](https://serenity-js.org/api/web/class/ModalDialog/#acceptNextWithValue).\n     *\n     * @param value\n     */\n    static acceptNextWithValue(value) {\n        return Page_1.Page.current().modalDialog().acceptNextWithValue(value)\n            .describedAs((0, core_1.the) `Haxxor accepts next modal dialog window with value ${value}`);\n    }\n    /**\n     * Produces an [interaction](https://serenity-js.org/api/core/class/Interaction/) that invokes [`ModalDialog.dismissNext`](https://serenity-js.org/api/web/class/ModalDialog/#dismissNext).\n     */\n    static dismissNext() {\n        return Page_1.Page.current().modalDialog().dismissNext()\n            .describedAs((0, core_1.the) `Haxxor dismisses next modal dialog window`);\n    }\n    /**\n     * [`QuestionAdapter`](https://serenity-js.org/api/core/#QuestionAdapter) that resolves to [`ModalDialog.message`](https://serenity-js.org/api/web/class/ModalDialog/#message) for the current [`Page`](https://serenity-js.org/api/web/class/Page/).\n     */\n    static lastDialogMessage() {\n        return Page_1.Page.current().modalDialog().last().message()\n            .describedAs(`last dialog message`);\n    }\n    /**\n     * [`QuestionAdapter`](https://serenity-js.org/api/core/#QuestionAdapter) that resolves to [`ModalDialog.state`](https://serenity-js.org/api/web/class/ModalDialog/#state) for the current [`Page`](https://serenity-js.org/api/web/class/Page/).\n     */\n    static lastDialogState() {\n        return Page_1.Page.current().modalDialog().last().state()\n            .describedAs(`last dialog state`);\n    }\n    /**\n     * Returns `accepted` or `dismissed` for dialogs that have been handled,\n     * or `absent` for those that haven&apos;t been handled yet.\n     */\n    state() {\n        return this.constructor.name\n            .replace(&apos;ModalDialog&apos;, &apos;&apos;)\n            .toLowerCase();\n    }\n} does become present","startTime":"2025-06-15T10:34:49.657Z","children":[],"reportData":[],"screenshots":[],"duration":1044,"result":"SUCCESS"},{"number":16,"description":"Haxxor takes notes:\n- alert_message: &quot;xss&quot;","startTime":"2025-06-15T10:34:50.711Z","children":[],"reportData":[],"screenshots":[],"duration":1,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":1067,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":1250,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":1290,"result":"SUCCESS"},{"number":17,"description":"Then she sees an alert message containing &quot;xss&quot;","startTime":"2025-06-15T10:34:50.744Z","children":[{"number":18,"description":"Haxxor confirms alert message is xss","startTime":"2025-06-15T10:34:50.747Z","children":[{"number":19,"description":"Haxxor ensures that &quot;xss&quot; does equal &quot;xss&quot;","startTime":"2025-06-15T10:34:50.747Z","children":[],"reportData":[],"screenshots":[],"duration":8,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":50,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":3,"result":"SUCCESS"},{"number":20,"description":"And she sees she has solved the &quot;DOM XSS&quot; challenge","startTime":"2025-06-15T10:34:50.747Z","children":[{"number":21,"description":"Haxxor confirms that DOM XSS has been solved","startTime":"2025-06-15T10:34:50.752Z","children":[{"number":22,"description":"Haxxor sends a GET request to &apos;/api/Challenges/?name=DOM XSS&apos;","startTime":"2025-06-15T10:34:50.752Z","children":[],"reportData":[],"screenshots":[],"duration":449,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":471,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":7,"result":"SUCCESS"}],"userStory":{"id":"juice-shop-is-susceptible-to-xss-attacks","storyName":"Juice Shop is susceptible to XSS attacks","displayName":"Juice Shop is susceptible to XSS attacks","path":"xss-dom/xss-dom","type":"feature","narrative":"","pathElements":[{"name":"xss-dom","description":"Xss-dom"},{"name":"xss-dom","description":"Xss-dom"}]},"startTime":"2025-06-15T10:34:46.269Z","testSource":"JS","tags":[{"name":"Xss-dom","type":"capability","displayName":"Xss-dom"},{"name":"Xss-dom/Juice Shop is susceptible to XSS attacks","type":"feature","displayName":"Juice Shop is susceptible to XSS attacks"}],"featureTag":{"name":"Xss-dom/Juice Shop is susceptible to XSS attacks","type":"feature","displayName":"Juice Shop is susceptible to XSS attacks"},"actors":[{"name":"Haxxor","can":["PerformActivities","AnswerQuestions","RaiseErrors","ScheduleWork { scheduler: { clock: { timeAdjustment: { milliseconds: 0 } }, interactionTimeout: { milliseconds: 5000 } } }","BrowseTheWeb (BrowseTheWebWithPlaywright)","CallAnApi { baseURL: \"https://stc-owasp-juice-dnebatcgf2ddf4cr.uksouth-01.azurewebsites.net/#/\", headers: { common: { Accept: \"application/json, text/plain, */*\" } }, timeout: 10000 }","TakeNotes { notepad: { alert_message: \"xss\" } }"]}],"result":"SUCCESS","duration":4507}